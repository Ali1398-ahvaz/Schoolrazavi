<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>فرم روزانه مطالعه</title>
  <style>
    body { font-family: Vazir, sans-serif; background: #f5f9ff; padding: 20px; }
    .card { max-width: 800px; margin: auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px #ccc; }
    h2 { color: #0f4c75; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    .disabled { background: #eee; color: #888; }
    .controls { margin-top: 20px; display: flex; gap: 10px; justify-content: flex-end; }
    button { padding: 8px 12px; border: none; border-radius: 6px; cursor: pointer; }
    .save { background: #0f4c75; color: #fff; }
    .send { background: #3282b8; color: #fff; }
  </style>
</head>
<body>
<div class="card">
  <h2>فرم برنامه‌ریزی مطالعه روزانه</h2>
  <div id="summary"></div>
  <table id="schedule">
    <thead>
      <tr><th>روز</th><th>نوبت ۱</th><th>نوبت ۲</th><th>نوبت ۳</th></tr>
    </thead>
    <tbody></tbody>
  </table>
  <div class="controls">
    <button class="save" onclick="saveToday()">💾 ذخیره امروز</button>
    <button class="send" onclick="sendWeek()">📤 ارسال نهایی</button>
  </div>
</div>

<script>
const days = ['شنبه','یک‌شنبه','دوشنبه','سه‌شنبه','چهارشنبه','پنج‌شنبه','جمعه'];
const lessons = ['','ریاضی','علوم','ادبیات','عربی','مطالعات','زبان','مرور'];
const todayIndex = new Date().getDay(); // 0=یک‌شنبه, 6=شنبه → نیاز به تنظیم برای تقویم شمسی

function getPersianDay(index) {
  return days[(index + 6) % 7]; // تطبیق با تقویم شمسی
}

const tbody = document.querySelector('#schedule tbody');
for (let i = 0; i < 7; i++) {
  const dayName = getPersianDay(i);
  const tr = document.createElement('tr');
  tr.innerHTML = `<td>${dayName}</td>` +
    ['1','2','3'].map(n => {
      const key = `${dayName}_n${n}`;
      const saved = localStorage.getItem(key) || '';
      const disabled = i === todayIndex ? '' : 'disabled';
      return `<td><select ${disabled} onchange="save('${key}', this.value)">
        ${lessons.map(l => `<option value="${l}" ${l===saved?'selected':''}>${l||'درس'}</option>`).join('')}
      </select></td>`;
    }).join('');
  tbody.appendChild(tr);
}

function save(key, value) {
  localStorage.setItem(key, value);
  updateSummary();
}

function saveToday() {
  alert('اطلاعات امروز ذخیره شد ✅');
}

function sendWeek() {
  let summary = '';
  for (let i = 0; i < 7; i++) {
    const day = getPersianDay(i);
    summary += `${day}: `;
    for (let n = 1; n <= 3; n++) {
      const val = localStorage.getItem(`${day}_n${n}`) || '—';
      summary += `نوبت ${n}: ${val} | `;
    }
    summary += '\n';
  }
  alert('ارسال به مدیر:\n\n' + summary);
}

function updateSummary() {
  let filled = 0;
  for (let i = 0; i < 7; i++) {
    for (let n = 1; n <= 3; n++) {
      const val = localStorage.getItem(`${getPersianDay(i)}_n${n}`);
      if (val) filled++;
    }
  }
  document.getElementById('summary').textContent = `✅ تعداد نوبت‌های تکمیل‌شده: ${filled}`;
}
updateSummary();
</script>
</body>
</html>
